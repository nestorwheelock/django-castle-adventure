# Endings Guide

**Project:** django-castle-adventure v1.0.0
**Total Endings:** 5 (3 primary + 2 bonus/secret)

---

## Ending Philosophy

**Goals:**
- Multiple endings encourage replay
- Endings reflect player choices and playstyle
- Each ending feels earned and distinct
- Dark humor maintained even in "victory" endings
- Secret endings reward thorough exploration

**Ending Types:**
- **Victory:** Player succeeds at rescue mission
- **Twist:** Player succeeds but with unexpected consequence
- **Betrayal:** Player is double-crossed
- **Comedy:** Player "succeeds" in the most chaotic way possible
- **Secret:** Hidden ending requires specific actions

---

## Ending Descriptions

### E1: Heroic Rescue ⭐ (Primary Victory)

**Scene ID:** E1
**Type:** Victory
**Difficulty:** Medium

**Requirements:**
- ✅ Have Tower Key (from behind throne)
- ✅ Have Dragon's Flame (from dragon's cave)
- ✅ Have Magic Spectacles (from troll)
- ✅ Helped at least 2 NPCs without violence
- ✅ Chose helpful/competent dialogue with princess

**How to Achieve:**
1. Complete critical path: Garden → Hounds → Castle → Library
2. Answer troll's riddle correctly OR bribe with goblet
3. Sneak past dragon OR negotiate with mice
4. Use spectacles to find invisible message
5. Retrieve tower key from throne room
6. Melt ice with dragon's flame
7. Unlock princess's door
8. Choose humble/helpful dialogue options

**Full Ending Text:**
```
Princess Elara carefully evaluates you. She notices the magic spectacles, the dragon's flame, the careful way you solved puzzles instead of breaking things.

"Not bad," she finally says. "You actually used your brain. I respect that."

Together, you descend the tower. As you pass through the castle:
- The dragon waves from his cave: "Thank you for not waking me violently!"
- The troll calls out: "Good luck, clever one!"
- The wizard peers out: "Goodbye, pizza! Or whoever you are!"

The castle begins to trumble as the curse weakens. Outside the walls, the storm clears. Dawn breaks.

Princess Elara looks at you with grudging approval. "You're more competent than you look. Thanks."

From her, that's high praise.

YOU WIN!

═══════════════════════════════════════
ACHIEVEMENT UNLOCKED: HEROIC RESCUE
The classic ending. Well done!
═══════════════════════════════════════
```

**Post-Credits Scene:**
"Three months later, the tavern bard sings songs of your rescue. Princess Elara has become a diplomat. The dragon sends you thank-you notes. The troll has published a riddle book. All is well. You occasionally wonder if it was all a fever dream. Then the dragon visits for tea and you remember: yes, this is your life now."

---

### E2: Tragic Betrayal 🗡️ (Dark Twist)

**Scene ID:** E2
**Type:** Betrayal/Death (but counts as story ending)
**Difficulty:** Easy to accidentally trigger

**Requirements:**
- ✅ Reached princess's chamber
- ❌ Did NOT help NPCs (killed them or ignored them)
- ❌ Did NOT obtain Royal Seal
- ❌ Chose boastful/aggressive dialogue

**How to Trigger:**
1. Reach princess through violence/brute force
2. Kill or ignore NPCs (troll, dragon, wizard)
3. Collect only minimum items needed (key, flame)
4. Choose "I've come to save you!" (boastful option)
5. Don't demonstrate cleverness or compassion

**Full Ending Text:**
```
Princess Elara looks you up and down. She sees the blood on your hands, the way you kicked down doors instead of using keys, the trail of destruction behind you.

She smiles sweetly. Too sweetly.

"My hero," she says warmly, approaching you.

Then she PUSHES.

You tumble backward off the balcony. As you fall, she leans over the railing:

"The curse requires a sacrifice every year. You're very sacrificial-looking! Nothing personal—you just made it SO easy. Thanks for breaking in!"

Your last thought as you plummet: "I should have read the warning signs."

The last thing you see is her waving cheerfully.

GAME OVER

═══════════════════════════════════════
ENDING UNLOCKED: TRAGIC BETRAYAL
Maybe read people better next time?
═══════════════════════════════════════
```

**Post-Credits Scene:**
"The castle curse continues. Princess Elara remains in her tower, waiting for next year's 'rescuer.' The dragon feels bad about your death but he barely knew you. The troll names a riddle after you: 'What arrives heroically and leaves vertically?' Your legacy lives on."

---

### E3: Mutual Escape 🤝 (Partnership Victory)

**Scene ID:** E3
**Type:** Victory (Cooperative)
**Difficulty:** Medium-Hard

**Requirements:**
- ✅ Have Royal Seal (from wizard)
- ✅ Befriended dragon (mice/cheese interaction)
- ✅ Befriended troll (answered riddle politely)
- ✅ Befriended wizard (played along with confusion)
- ✅ Chose partnership dialogue with princess

**How to Achieve:**
1. Complete exploration thoroughly (talk to all NPCs)
2. Use cleverness over violence
3. Obtain Royal Seal from wizard (play along with pizza mix-up)
4. Use cheese to befriend dragon
5. Answer troll's riddle respectfully
6. Choose "Need help with that rope?" or "Let's work together" with princess
7. Pool resources and knowledge

**Full Ending Text:**
```
Princess Elara's eyes light up when you show her the Royal Seal.

"You convinced MERVIN to give you that? I'm impressed. He thinks everyone is pizza." She grins. "You're smarter than most. I like smart."

She shows you HER escape plan—a secret passage she discovered behind the bookshelf. "Combine my route with your items and allies..."

Together you execute the plan:
- You use the Royal Seal to command open the secret passage
- The dragon (your friend now) gives you a ride over the outer walls
- The troll packs you travel snacks: "For the clever ones!"
- Mervin thinks you're both pizza leaving the warming oven

Outside, the curse breaks. The castle transforms—less ominous, more normal.

Princess Elara extends her hand. "Partners?"

You shake it. "Partners."

The dragon waves goodbye. The troll goes back to his riddles. Mervin wonders where his pizza went.

PERFECT ENDING!

═══════════════════════════════════════
ACHIEVEMENT UNLOCKED: MUTUAL ESCAPE
Cooperation beats solo heroics!
═══════════════════════════════════════
```

**Post-Credits Scene:**
"You and Princess Elara become professional adventurers. Your teamwork is legendary. The dragon writes you letters. The troll sends riddles. Mervin occasionally accosts you asking about pizza. You visit the castle sometimes—it's a library now. Much less murderous. Progress!"

---

### E4: Castle Collapse 💥 (Chaotic Comedy)

**Scene ID:** E4
**Type:** Comedy Victory (Technically success?)
**Difficulty:** Hard to do accidentally, easy if intentional

**Requirements:**
- ✅ Woke dragon violently (chose "wake and ask" option)
- ✅ Killed or angered multiple NPCs
- ✅ Broke structural elements (animated armor fight, etc.)
- ✅ Generally caused chaos
- ❌ Reached tower (maybe)

**How to Trigger:**
1. Choose violent/chaotic options consistently
2. Wake dragon with aggression
3. Fight animated armor (trigger guard response)
4. Destroy castle elements
5. Accumulate "destruction points" (tracked in game state)
6. Castle structural integrity fails

**Full Ending Text:**
```
The castle has endured centuries of dark magic, supernatural curses, and malevolent energy.

It could not endure YOU.

Your rampage through the halls has consequences:
- The dragon fled, terrified of your violence
- The troll evacuated with his riddle collection
- The wizard apparated to safety muttering about aggressive pizza
- The animated armor filed a complaint with the Haunted Armor Union

The structural damage is catastrophic.

The walls CRACK. The foundations CRUMBLE. The ceiling COLLAPSES.

In the chaos, Princess Elara escapes on her own, stealing a horse from the stable. She sees you in the rubble and shouts:

"THANKS FOR THE DISTRACTION, IDIOT!"

She rides off into the sunset.

You're buried under three tons of masonry but somehow survive. The local tavern hears the story and names a drink after you: "THE CASTLE DESTROYER"—it's flammable and ruins everything it touches.

You're famous for being terrible at this. Success?

═══════════════════════════════════════
ENDING UNLOCKED: CASTLE COLLAPSE
You saved the princess by demolishing her prison!
(She saved herself, but still.)
═══════════════════════════════════════
```

**Post-Credits Scene:**
"The kingdom debates whether you're a hero or a menace. The princess won't return your letters. The dragon has PTSD. The troll wrote a riddle: 'What destroys castles and subtlety in equal measure?' You're banned from 17 other castles. At least you're memorable."

---

### E5: Become the New Ruler 👑 (Secret Ending)

**Scene ID:** E5
**Type:** Secret/Ironic
**Difficulty:** Very Hard (requires specific knowledge and all items)

**Requirements:**
- ✅ Collect ALL items (Magic Spectacles, Dragon's Flame, Tower Key, Royal Seal, Golden Goblet, Cheese, Ancient Tome)
- ✅ Befriend ALL NPCs (dragon, troll, wizard)
- ✅ After getting Tower Key, return to throne room
- ✅ Sit on the cursed throne while holding all items
- ✅ Special trigger: "Sit on throne" choice only appears with all items + all NPCs befriended

**How to Achieve:**
1. Explore EVERYTHING (all optional areas)
2. Collect every single item in the game
3. Befriend every single NPC
4. After obtaining tower key from throne room, a new choice appears: "Sit on the throne"
5. This choice only appears if you have all items and helped all NPCs
6. Sitting on throne triggers ancient prophecy

**Full Ending Text:**
```
As you sit on the cursed throne, holding all seven items and having shown kindness to every creature in the castle, something unexpected happens.

The items GLOW. The throne PULSES with energy.

An ancient voice echoes:

"Bearer of all treasures, friend to all creatures, solver of all mysteries, heir to the throne of shadows. The curse is fulfilled. The crown passes."

The skeleton king crumbles to dust. The crown floats and settles on YOUR head.

Princess Elara appears. "Huh. The prophecy was real. Neat!" She shrugs. "I didn't want to rule anyway. Too much paperwork. I'm going to become an adventurer. Have fun!"

She leaves.

You're now the ruler of Castle Shadowmere.

The dragon pokes his head in: "Does this mean I get dental coverage?"
The troll arrives: "My liege, I have prepared 400 riddles for your coronation!"
The wizard wanders in: "Has anyone seen my pizza? Oh, hello, your majesty. You look like pizza."

This is your life now.

You wanted to be a hero. Instead, you're a middle manager for supernatural beings.

The throne is surprisingly comfortable, though.

Congratulations?

═══════════════════════════════════════
SECRET ENDING UNLOCKED: NEW RULER
You completed EVERYTHING and got the secret ending!
═══════════════════════════════════════
```

**Post-Credits Scene:**
"Ten years later: Castle Shadowmere is now a surprisingly well-run administrative center. You've implemented a riddle-of-the-month program, the dragon manages the heating system, the troll teaches logic classes, and Mervin still thinks you're pizza. Former Princess Elara sends postcards from her adventures. You're... content? Who knew ruling a cursed castle could be fulfilling? Still weird about the pizza thing, though."

---

## Ending Statistics & Tracking

**Endings Discovery Rate (Expected):**
- E1 (Heroic Rescue): 60% of players
- E2 (Tragic Betrayal): 30% of players (often by accident)
- E3 (Mutual Escape): 20% of players (requires thoroughness)
- E4 (Castle Collapse): 10% of players (usually intentional)
- E5 (New Ruler): 5% of players (secret, requires guide or luck)

**Replay Incentive:**
- Players who get E2 will replay to "win properly"
- Players who get E1 will explore for other endings
- E5 is designed for completionists and guides

**In-Game Ending Tracker:**
```
ENDINGS DISCOVERED: X/5

⭐ Heroic Rescue: [LOCKED/UNLOCKED]
🗡️ Tragic Betrayal: [LOCKED/UNLOCKED]
🤝 Mutual Escape: [LOCKED/UNLOCKED]
💥 Castle Collapse: [LOCKED/UNLOCKED]
👑 New Ruler: [SECRET - ???]
```

---

## Ending Implementation Notes

**Database Fields:**
- `ending_id` (E1-E5)
- `ending_title`
- `ending_description` (full text)
- `ending_type` (victory/betrayal/comedy/secret)
- `achievement_unlocked` (boolean per user)

**Game State Checks:**
```python
def determine_ending(game_state):
    items = game_state.inventory
    npc_relations = game_state.npc_relations
    chaos_level = game_state.chaos_points

    # Secret ending check first (most specific)
    if all_items_collected() and all_npcs_befriended() and sat_on_throne():
        return 'E5'

    # Chaos ending
    if chaos_level > 10:
        return 'E4'

    # Partnership ending
    if 'royal_seal' in items and npc_relations['dragon'] > 0 and npc_relations['troll'] > 0:
        return 'E3'

    # Betrayal ending
    if npc_relations['total'] < 0 or player_was_violent():
        return 'E2'

    # Default heroic ending
    return 'E1'
```

---

**Document Status:** Complete
**Last Updated:** 2025-10-02
